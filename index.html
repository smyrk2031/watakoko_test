<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>わたここ！ver0.1.4</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.js"></script>
    <link href="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.css" rel="stylesheet" />
</head>
<body>
    <!-- ハンバーガーメニューボタン -->
    <button id="hamburger-btn" class="hamburger-btn">
        <span></span>
        <span></span>
        <span></span>
    </button>

    <!-- サイドバー -->
    <div id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <h2>メニュー</h2>
        </div>
        <nav class="sidebar-nav">
            <a href="#" id="nav-main" class="nav-item active">メイン画面</a>
            <a href="#" id="nav-settings" class="nav-item">ユーザー設定</a>
            <a href="#" id="nav-map" class="nav-item">マップ画面</a>
        </nav>
    </div>

    <!-- オーバーレイ -->
    <div id="overlay" class="overlay"></div>

    <!-- メインコンテナ -->
    <div id="main-container" class="main-container">
        
        <!-- ユーザー設定画面 -->
        <div id="user-settings-screen" class="screen">
            <div class="screen-header">
                <h1>ユーザー設定</h1>
                <div class="header-decoration"></div>
            </div>
            
            <div class="settings-form">
                <div class="form-group">
                    <label for="username">ユーザー名（最大20文字）</label>
                    <input type="text" id="username" maxlength="20" placeholder="お名前を入力してください">
                </div>
                
                <div class="form-group">
                    <label for="user-id">ID（7桁数字）</label>
                    <input type="number" id="user-id" maxlength="7" placeholder="1234567" pattern="[0-9]{7}">
                </div>
                
                <div class="form-group">
                    <label for="user-group">グループ</label>
                    <select id="user-group">
                        <option value="営業部">営業部</option>
                        <option value="開発部">開発部</option>
                        <option value="管理部">管理部</option>
                        <option value="A棟ユーザー">A棟ユーザー</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="user-icon">アイコン画像</label>
                    
                    <!-- デフォルトアイコン選択 -->
                    <div class="default-icons-section">
                        <h4>デフォルトアイコンを選択</h4>
                        <div class="default-icons-grid">
                            <div class="default-icon-item" data-icon="person">
                                <svg width="40" height="40" viewBox="0 0 40 40">
                                    <circle cx="20" cy="12" r="6" fill="#4ECDC4"/>
                                    <path d="M8 32c0-6.627 5.373-12 12-12s12 5.373 12 12" fill="#4ECDC4"/>
                                </svg>
                                <span>人物</span>
                            </div>
                            <div class="default-icon-item" data-icon="star">
                                <svg width="40" height="40" viewBox="0 0 40 40">
                                    <path d="M20 4l4.9 9.9 10.9 1.6-7.9 7.7 1.9 10.8L20 29.8 10.2 34l1.9-10.8L4.2 15.5l10.9-1.6z" fill="#FFD700"/>
                                </svg>
                                <span>星</span>
                            </div>
                            <div class="default-icon-item" data-icon="heart">
                                <svg width="40" height="40" viewBox="0 0 40 40">
                                    <path d="M20 35c-1.1 0-2-.9-2-2 0-.6.2-1.1.6-1.5L32 18c2.2-2.2 2.2-5.8 0-8s-5.8-2.2-8 0L20 14 16 10c-2.2-2.2-5.8-2.2-8 0s-2.2 5.8 0 8l13.4 13.5c.4.4.6.9.6 1.5 0 1.1-.9 2-2 2z" fill="#FF6B6B"/>
                                </svg>
                                <span>ハート</span>
                            </div>
                            <div class="default-icon-item" data-icon="flower">
                                <svg width="40" height="40" viewBox="0 0 40 40">
                                    <circle cx="20" cy="20" r="4" fill="#98D8C8"/>
                                    <ellipse cx="20" cy="10" rx="3" ry="6" fill="#98D8C8"/>
                                    <ellipse cx="30" cy="20" rx="6" ry="3" fill="#98D8C8"/>
                                    <ellipse cx="20" cy="30" rx="3" ry="6" fill="#98D8C8"/>
                                    <ellipse cx="10" cy="20" rx="6" ry="3" fill="#98D8C8"/>
                                </svg>
                                <span>花</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="or-divider">または</div>
                    
                    <!-- カスタムアイコンアップロード -->
                    <div class="icon-upload-area" id="icon-upload-area">
                        <div class="upload-text">
                            <p>📷 画像をドラッグ＆ドロップ</p>
                            <p>📋 画像をコピーしてCtrl+Vで貼り付け</p>
                            <button type="button" class="file-select-btn">ファイルを選択</button>
                        </div>
                        <input type="file" id="user-icon" accept=".jpg,.jpeg,.png,.ico" style="display: none;">
                        <div class="preview-area" id="preview-area" style="display: none;">
                            <div class="icon-preview-circle">
                                <img id="icon-preview" src="" alt="アイコンプレビュー">
                            </div>
                        </div>
                    </div>
                </div>
                
                <button id="save-settings-btn" class="primary-btn">設定を保存</button>
            </div>
        </div>

        <!-- メイン画面 -->
        <div id="main-screen" class="screen">
            <div class="screen-header">
                <div class="header-character-container">
                    <div class="header-character left-character">
                        <img src="charactor_img_01.png" alt="わたこ" class="character-img">
                    </div>
                    <button id="location-btn" class="location-btn header-location-btn">
                        <span class="btn-icon">📍</span>
                        私はここにいる！
                    </button>
                    <div class="header-character right-character">
                        <img src="charactor_img_01.png" alt="わたこ" class="character-img">
                    </div>
                </div>
                <div class="header-decoration"></div>
            </div>
            
            <div class="main-content">
                <div class="location-section">
                    <!-- 元のボタンは削除 -->
                    
                    <div id="location-result" class="location-result" style="display: none;">
                        <div class="current-building">
                            <h3 id="building-name">建物名</h3>
                        </div>
                        
                        <div class="floor-selection" id="floor-selection" style="display: none;">
                            <h4>階層を選択してください</h4>
                            <div id="floor-buttons" class="floor-buttons"></div>
                        </div>
                        
                        <div class="room-selection" id="room-selection" style="display: none;">
                            <h4>部屋を選択してください</h4>
                            <div id="room-list" class="room-list"></div>
                        </div>
                        
                        <button id="register-location-btn" class="primary-btn" style="display: none;">
                            位置を登録
                        </button>
                    </div>
                </div>
                
                <div class="map-container">
                    <div class="map-controls">
                        <button id="toggle-buildings-btn" class="control-btn">建物範囲表示</button>
                        <button id="toggle-members-btn" class="control-btn">みんどこ？</button>
                        <div class="group-filter" id="group-filter" style="display: none;">
                            <select id="group-select">
                                <option value="all">全て表示</option>
                                <option value="営業部">営業部</option>
                                <option value="開発部">開発部</option>
                                <option value="管理部">管理部</option>
                                <option value="A棟ユーザー">A棟ユーザー</option>
                            </select>
                        </div>
                    </div>
                    <div id="map" class="map"></div>
                </div>
                
                <!-- 手動位置入力 - マップの下に配置 -->
                <div id="manual-location-input" class="manual-location-input" style="display: none;">
                    <div class="manual-input-header">
                        <h3>📍 手動で場所を入力</h3>
                        <p>建物の範囲外にいるため、場所を手動で入力してください</p>
                    </div>
                    
                    <div class="manual-input-field">
                        <label for="manual-location-text">場所名</label>
                        <input type="text" id="manual-location-text" placeholder="例：カフェ○○、公園、自宅など" maxlength="50">
                    </div>
                    
                    <button id="register-manual-location-btn" class="primary-btn">
                        手動で位置を登録
                    </button>
                </div>
            </div>
        </div>

        <!-- マップ画面 -->
        <div id="map-screen" class="screen" style="display: none;">
            <div class="screen-header">
                <h1>マップ</h1>
                <div class="header-decoration"></div>
            </div>
            
            <div class="map-section">
                <div class="full-map-container">
                    <div class="map-controls">
                        <button id="map-toggle-buildings-btn" class="control-btn">建物範囲表示</button>
                        <button id="map-toggle-members-btn" class="control-btn">みんどこ？</button>
                        <div class="group-filter" id="map-group-filter" style="display: none;">
                            <select id="map-group-select">
                                <option value="all">全て表示</option>
                                <option value="営業部">営業部</option>
                                <option value="開発部">開発部</option>
                                <option value="管理部">管理部</option>
                                <option value="A棟ユーザー">A棟ユーザー</option>
                            </select>
                        </div>
                    </div>
                    
                    <div id="full-map-container-wrapper" style="position: relative;">
                        <div id="full-map" class="full-map"></div>
                    </div>
                </div>
                
                <!-- 手動位置入力 - マップの下に配置 -->
                <div id="map-manual-location-input" class="manual-location-input map-manual-input" style="display: none;">
                    <div class="manual-input-header">
                        <h3>📍 手動で場所を入力</h3>
                        <p>建物の範囲外にいるため、場所を手動で入力してください</p>
                    </div>
                    
                    <div class="manual-input-field">
                        <label for="map-manual-location-text">場所名</label>
                        <input type="text" id="map-manual-location-text" placeholder="例：カフェ○○、公園、自宅など" maxlength="50">
                    </div>
                    
                    <div class="manual-input-buttons">
                        <button id="map-register-manual-location-btn" class="primary-btn">
                            手動で位置を登録
                        </button>
                        <button id="map-close-manual-input-btn" class="secondary-btn">
                            キャンセル
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 位置登録画面 -->
        <div id="location-screen" class="screen" style="display: none;">
            <div class="screen-header">
                <h1>位置登録</h1>
                <div class="header-decoration"></div>
            </div>
            
            <div id="map-container">
                <div id="map"></div>
            </div>
            
            <div class="location-section">
                <button id="get-location-btn" class="primary-btn">
                    📍 私はここにいる！
                </button>
                
                <div id="building-selection" style="display: none;">
                    <div class="selection-group">
                        <label>建物:</label>
                        <select id="building-select">
                            <option value="">建物を選択</option>
                        </select>
                    </div>
                    
                    <div class="selection-group">
                        <label>フロア:</label>
                        <select id="floor-select" disabled>
                            <option value="">フロアを選択</option>
                        </select>
                    </div>
                    
                    <div class="selection-group">
                        <label>部屋:</label>
                        <select id="room-select" disabled>
                            <option value="">部屋を選択</option>
                        </select>
                    </div>
                    
                    <button id="register-location-btn" class="primary-btn" disabled>
                        位置を登録
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- メンバー詳細ポップアップ -->
    <div id="member-popup" class="member-popup" style="display: none;">
        <div class="popup-content">
            <button class="popup-close">&times;</button>
            <div class="member-info">
                <img id="popup-icon" src="" alt="アイコン">
                <div class="member-details">
                    <h3 id="popup-username">ユーザー名</h3>
                    <p id="popup-status">ステータス</p>
                    <p id="popup-location">位置情報</p>
                    <p id="popup-note">メモ</p>
                    <p id="popup-timestamp">更新時刻</p>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html> 